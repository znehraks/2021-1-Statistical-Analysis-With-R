summary(r)
70.9481+67*1.5218
70.9481+68*1.5218
plot(r)
#multi
attach(iris)
iris_m=lm(Sepal.Length~Sepal.Width+Petal.Length+Petal.Width, data=iris)
summary(m)
summary(iris_m)
plot(iris_m)
plot(iris_m)
iris_m=lm(Sepal.Length~.,data = iris)
summary(iris_m)
plot(iris_m)
model.matrix(m)[c(1,51,101),]
model.matrix(iris_m)[c(1,51,101),]
anova(iris_m)
with(iris, plot(Sepal.Width, Sepal.Length, cex=.7, pch=as.numeric(Species)))
(m=lm(Sepal.Length~Sepal.Width+Species, data=iris))
coef(m)
abline(2.25,0.80,lty=1)
abline(2.25+1.45,0.80,lty=2)
abline(2.25+1.94,0.80,lty=3)
ad = read.csv("ad.csv")
ad
str(ad)
set.seed(100)
trainingRowIndex = sample(1:nrow(ad), 0.6*nrow(ad))
trainingData = ad[trainingRowIndex,]
testData = ad[-trainingRowIndex,]
lmAd = lm(sales,., data=trainingData)
attach(ad)
lmAd = lm(sales,., data=trainingData)
lmAd = lm(sales~., data=trainingData)
summary(lmAd)
ad[-X]
library(dplyr)
ad = ad %>%
select(-X)
str(ad)
attach(ad)
set.seed(100)
trainingRowIndex = sample(1:nrow(ad), 0.6*nrow(ad))
trainingData = ad[trainingRowIndex,]
testData = ad[-trainingRowIndex,]
lmAd = lm(sales~., data=trainingData)
summary(lmAd)
distPred = predict(lmAd, testData)
distPred
head(actuals_preds)
cor_acc = cor(actuals_preds)
cor_acc
library(dplyr)
#데이터 로드 및 정제
ad = read.csv("ad.csv")
ad = ad %>%
select(-X)
str(ad)
attach(ad)
#난수 생성 및 훈련데이터와 검정데이터 생성
set.seed(100)
trainingRowIndex = sample(1:nrow(ad), 0.6*nrow(ad))
trainingData = ad[trainingRowIndex,]
testData = ad[-trainingRowIndex,]
#다중선형회귀모델 생성(종속변수가 sales(판매량)이며 독립변수가 TV,radio,
#newspaper로 이루어진 모든 경우)
lmAd = lm(sales~., data=trainingData)
summary(lmAd)
salesPred = predict(lmAd, testData)
salesPred
actuals_preds = data.frame(cbind(actuals = testData$sales, predict=salesPred))
head(actuals_preds)
cor_acc = cor(actuals_preds)
cor_acc
plot(ad)
plot(lmAd)
salesPred
#난수 생성 및 훈련데이터와 검정데이터 생성
set.seed(100)
trainingRowIndex = sample(1:nrow(ad), 0.6*nrow(ad))
trainingData = ad[trainingRowIndex,]
testData = ad[-trainingRowIndex,]
#다중선형회귀모델 생성(종속변수가 sales(판매량)이며 독립변수가 TV,radio,
#newspaper로 이루어진 모든 경우)
lmAd = lm(sales~., data=trainingData)
summary(lmAd)
plot(lmAd)
cor_acc = cor(actuals_preds)
cor_acc
#난수 생성 및 훈련데이터와 검정데이터 생성
set.seed(50)
trainingRowIndex = sample(1:nrow(ad), 0.6*nrow(ad))
trainingData = ad[trainingRowIndex,]
testData = ad[-trainingRowIndex,]
#다중선형회귀모델 생성(종속변수가 sales(판매량)이며 독립변수가 TV,radio,
#newspaper로 이루어진 모든 경우)
lmAd = lm(sales~., data=trainingData)
summary(lmAd)
plot(lmAd)
cor_acc = cor(actuals_preds)
cor_acc
#난수 생성 및 훈련데이터와 검정데이터 생성
set.seed(100)
trainingRowIndex = sample(1:nrow(ad), 0.6*nrow(ad))
trainingData = ad[trainingRowIndex,]
testData = ad[-trainingRowIndex,]
#다중선형회귀모델 생성(종속변수가 sales(판매량)이며 독립변수가 TV,radio,
#newspaper로 이루어진 모든 경우)
lmAd = lm(sales~., data=trainingData)
summary(lmAd)
plot(lmAd)
cor_acc = cor(actuals_preds)
cor_acc
salesPred
#난수 생성 및 훈련데이터와 검정데이터 생성
set.seed(1000)
trainingRowIndex = sample(1:nrow(ad), 0.6*nrow(ad))
trainingData = ad[trainingRowIndex,]
testData = ad[-trainingRowIndex,]
#다중선형회귀모델 생성(종속변수가 sales(판매량)이며 독립변수가 TV,radio,
#newspaper로 이루어진 모든 경우)
lmAd = lm(sales~., data=trainingData)
#다중선형회귀모델 생성(종속변수가 sales(판매량)이며 독립변수가 TV,radio,
#newspaper로 이루어진 모든 경우)
lmAd = lm(sales~., data=trainingData)
summary(lmAd)
plot(lmAd)
cor_acc = cor(actuals_preds)
cor_acc
salesPred
set.seed(500)
trainingRowIndex = sample(1:nrow(ad), 0.6*nrow(ad))
trainingData = ad[trainingRowIndex,]
testData = ad[-trainingRowIndex,]
#다중선형회귀모델 생성(종속변수가 sales(판매량)이며 독립변수가 TV,radio,
#newspaper로 이루어진 모든 경우)
lmAd = lm(sales~., data=trainingData)
summary(lmAd)
plot(lmAd)
salesPred = predict(lmAd, testData)
salesPred
actuals_preds = data.frame(cbind(actuals = testData$sales, predict=salesPred))
head(actuals_preds)
cor_acc = cor(actuals_preds)
cor_acc
plot(ad)
#다중선형회귀모델 생성(종속변수가 sales(판매량)이며 독립변수가 TV,radio,
#newspaper로 이루어진 모든 경우)
lmAd = lm(sales~., data=trainingData)
summary(lmAd)
salesPred = predict(lmAd, testData)
salesPred
actuals_preds = data.frame(cbind(actuals = testData$sales, predict=salesPred))
head(actuals_preds)
actuals_preds
actuals_preds[1,]
actuals_preds[,1]
actuals_preds[,2]
head(actuals_preds)
cor_acc = cor(actuals_preds)
cor_acc
plot(lmAd)
with(iris, plot(Species, Petal.Length, xlab="Species", ylab="Petal.Length"))
m=lm(Petal.Length~Petal.Width*Species, data=iris)
anova(m)
summary(m)
install.packages("interactions")
library(interactions)
interact_plot(m,pred="Petal.Width",modx="Species", plot.points = TRUE)
x=1:1000
y = x^2+3*x+5+rnorm(1000)
lm(y~I(x^2)+x)
x=101:200
y=exp(3*x+rnorm(100))
lm(log(y)~x)
x=101:200
y=log(x)+rnorm(100)
lm(y~log(x))
library(MASS)
data("mammals")
head(mammals)
attach(mammals)
plot(body, brain)
model1 = lm(brain~body)
summary(model1)
plot(model1)
with(mammals, plot(body, brain, log = "xy"))
model2 = lm(log(brain)~log(body))
summary(model2)
par(mfrow=c(2,2), mar=c(2,3,1,5,0.5))
par(mfrow=c(2,2), mar=c(2,3,1.5,0.5))
plot(model2)
plot(density(model1$resid), main="model1")
plot(density(model2$resid). main="model2")
plot(density(model2$resid), main="model2")
install.packages("mlbench")
library(mlbench)
data("attitude")
m=lm(rating~., data=attitude)
m2=step(m, direction = "backword")
m2=step(m, direction = "backward")
summary(m2)
data("BostonHousing")
m=lm(medv~., data=BostonHousing)
m
m2=step(m,direction="both")
data("Ozone")
Ozone
data("airquality")
airquality
install.packages("mlbench")
library(mlbench)
m=lm(Ozone~., data=airquality)
summary(m)
m2=step(m, direction = "both")
summary(m2)
#1차 선형회귀모델 확인
summary(m)
m3=step(m, direction = "forward")
summary(m3)
m4=step(m, direction= "backward")
summary(m4)
m2=step(m, direction = "both")
m3=step(m, direction = "forward")
m4=step(m, direction= "backward")
library(mlbench)
#airquality 데이터를 로드함
data("airquality")
col1 = mapply(anyNA, airquality)
col1
for(i in 1:nrow(airquality)){
if(is.na(airquality[i,"Ozone"])){
airquality[i,"Ozone"]=mean(airquality[which(airquality[,"Month"]
== airquality[i,"Month"]),
"Ozone"],na.rm=T)
}
if(is.na(airquality[i,"Solar.R"])){
airquality[i,"Solar.R"]=mean(airquality[which(airquality[,"Month"]
== airquality[i,"Month"]),
"Solar.R"],na.rm=T)
}
}
#Ozone에 다른 변수들이 미치는 영향을 확인하기 위해, 1차로 모델을 생성
m=lm(Ozone~., data=airquality)
return((x-min(x))/(max(x)-min(x)))
airquality = normalize(airquality)
#정규화
normalize = function(x){
return((x-min(x))/(max(x)-min(x)))
}
airquality = normalize(airquality)
str(airquality)
head(airquality)
library(corrplot)
#상관관계 파악
airquality_cor = cor(airquality)
corrplot(airquality_cor, method = "color",
type="lower", addCoef.col = "black")
#1차 선형회귀모델 확인
Y = airquality[,"Ozone"]
X = airquality[,"Solar.R"]
model1 = lm(Y~X)
model1
plot(Y~X)
abline(model1, col="blue", lwd=3)
summary(model1)
#2차 선형회귀모델 확인 (바람과 오존의 모델)
Y = airquality[,"Ozone"]
X = airquality[,"Wind"]
model2 = lm(Y~X)
model2
plot(Y~X)
abline(model2, col="blue", lwd=3)
summary(model2)
library(ggplot2)
ggplot(data=airquality, aes(x=Ozone, y=forecast)) +
geom_point()+
geom_smooth(method = lm)+
labs(title="airquality linear regression model")
#1차 예측모델
airquality$forecast = predict(model1)
ggplot(data=airquality, aes(x=Ozone, y=forecast)) +
geom_point()+
geom_smooth(method = lm)+
labs(title="airquality linear regression model")
#2차 예측모델
airquality$forecast = predict(model2)
ggplot(data=airquality, aes(x=Ozone, y=forecast)) +
geom_point()+
geom_smooth(method = lm)+
labs(title="airquality linear regression model")
#1차 선형회귀모델 확인 (태양광과 오존의 모델)
Y = airquality[,"Ozone"]
X = airquality[,"Solar.R"]
model1 = lm(Y~X)
model1
plot(Y~X)
abline(model1, col="blue", lwd=3)
summary(model1)
#1차 예측모델
airquality$forecast1 = predict(model1)
ggplot(data=airquality, aes(x=Ozone, y=forecast)) +
geom_point()+
geom_smooth(method = lm)+
labs(title="airquality linear regression model")
#2차 선형회귀모델 확인 (바람과 오존의 모델)
Y = airquality[,"Ozone"]
X = airquality[,"Wind"]
model2 = lm(Y~X)
model2
plot(Y~X)
abline(model2, col="blue", lwd=3)
summary(model2)
#2차 예측모델
airquality$forecast2 = predict(model2)
ggplot(data=airquality, aes(x=Ozone, y=forecast2)) +
geom_point()+
geom_smooth(method = lm)+
labs(title="airquality linear regression model")
ggplot(data=airquality, aes(x=Ozone, y=forecast2)) +
geom_point()+
geom_smooth(method = lm)+
labs(title="airquality linear regression model")
ggplot(data=airquality, aes(x=Ozone, y=forecast)) +
geom_point()+
geom_smooth(method = lm)+
labs(title="airquality linear regression model")
ggplot(data=airquality, aes(x=Ozone, y=forecast1)) +
geom_point()+
geom_smooth(method = lm)+
labs(title="airquality linear regression model")
ggplot(data=airquality, aes(x=Ozone, y=forecast2)) +
geom_point()+
geom_smooth(method = lm)+
labs(title="airquality linear regression model")
#Ozone에 다른 변수들이 미치는 영향을 확인하기 위해, 1차로 모델을 생성
m=lm(Ozone~., data=airquality)
#Intercept, Solar.R, Wind, Temp, Month가 유의미한 영향력을 끼치는 것으로 확인
summary(m)
#전진선택, 후진제거, 단계적선택법 모두를 이용하여 모델을 만든결과,
#AIC가 679.71이며, Solar.R, Wind, Temp, Month로 이루어진 모델이 가장 최상의
#모델로 결정됨
#Ozone ~ Solar.R + Wind + Temp + Month
m2=step(m, direction = "both")
summary(m2)
m3=step(m, direction = "forward")
summary(m3)
m4=step(m, direction= "backward")
summary(m4)
install.packages("leaps")
library(leaps)
library(mlbench)
data("BostonHousing")
m=regsubsets(medv~.,data=BostonHousing)
m
summary(m)
plot(m, scale = "adjr2")
plot(m, scale = "bic")
(bestbic = summary(m)$bic)
(min.bic = which.min(bestbic))
coef(m,min.bic)
plot(m, scale = "adjr2")
plot(m, scale = "bic")
data("Orange")
Orange = rbind(Orange,
data.frame(Tree=as.factor(c(6,6,6)),
age=c(118,484,664),
circumference=c(177,50,30)))
with(Orange,
plot(Tree, circumference, xlab="tree",
ylab="circumference"))
with(Orange, interaction.plot(age, Tree, circumference))
m=lm(circumference ~ age+I(age^2), data=Orange)
outlierTest(,)
outlierTest(m)
Orange
m=lm(circumference ~ age+I(age^2), data=Orange)
summary(m)
plot(m)
install.packages("car")
library(car)
outlierTest(m)
install.packages("rpart")
library(rpart)
m=rpart(Species~.,data=iris)
m
prp(m, type=5, extra=2, digits=3)
install.packages("rpart.plot")
library(rpart.plot)
prp(m, type=5, extra=2, digits=3)
table(iris$Species, predict(m, newdata=irirs, type="class"))
table(iris$Species, predict(m, newdata=iris, type="class"))
str(Titanic)
titanic = read.csv("titanic_clean.csv")
str(Titanic)
str(titanic)
titanic = read.csv("titanic_clean.csv", header=T, sep=",")
str(titanic)
titanic$pclass=as.factor(titanic$pclass)
titanic$pclass=as.factor(titanic$pclass)
titanic$name=as.character(titanic$name)
titanic$ticket=as.character(titanic$ticket)
titanic$cabin=as.character(titanic$cabin)
titanic$survived=factor(titanic$survived, levels=c(0,1))
str(titanic)
library(ggplot2)
ggplot(titanic, aes(x=factor(pclass), fill=factor(sex)))+
geom_bar(position = "dodge")
ggplot(titanic, aes(x=factor(pclass), fill=factor(sex)))+
geom_bar(position = "dodge") +
facet_grid(".~survived")
posn.j=position_jitter(0,3,0)
ggplot(titanic, aes(x=factor(pclass), y=age, col=factor(sex)))+
geom_jitter(size=3, alpha=0.5, position=posn.j)+
facet_grid(".~survived")
posn.j=position_jitter(0.3,0)
ggplot(titanic, aes(x=factor(pclass), y=age, col=factor(sex)))+
geom_jitter(size=3, alpha=0.5, position=posn.j)+
facet_grid(".~survived")
mosaicplot(survived~pclass+sex, main="pclass and sex", data=titanic)
mosaicplot(survived~pclass+sex, main="pclass and sex", data=titanic,
color = T)
library(Hmisc)
summary(survived~pclass + sex + age + sibsp + parch + fare + embarked,
data=titanic, method = "reverse")
library(rpart)
library(rpart.plot)
set.seed(100)
trainingRowIndex = sample(1:nrow(titanic), 0.8*nrow(titanic))
trainingData = titanic[trainingRowIndex,]
testData = titanic[-trainingRowIndex,]
dt1 = rpart(survived~pclass+sex+age+sibsp+parch+fare+embarked,
data=trainingData)
prp(dt1, type=0, extra=2, digits=4)
prediction = predict(dt1, testData, type="class")
table(ifelse(testData$survived == prediction, "yes", "no"))
titanic = read.csv("titanic_clean.csv", header=T, sep=",")
str(titanic)
titanic$pclass=as.factor(titanic$pclass)
titanic$name=as.character(titanic$name)
titanic$ticket=as.character(titanic$ticket)
titanic$cabin=as.character(titanic$cabin)
titanic$survived=factor(titanic$survived, levels=c(0,1))
ggplot(titanic, aes(x=factor(pclass), fill=factor(sex)))+
geom_bar(position = "dodge")
ggplot(titanic, aes(x=factor(pclass), fill=factor(sex)))+
geom_bar(position = "dodge") +
facet_grid(".~survived")
posn.j=position_jitter(0.3,0)
ggplot(titanic, aes(x=factor(pclass), y=age, col=factor(sex)))+
geom_jitter(size=3, alpha=0.5, position=posn.j)+
facet_grid(".~survived")
mosaicplot(survived~pclass+sex, main="pclass and sex", data=titanic,
color = T)
library(Hmisc)
summary(survived~pclass + sex + age + sibsp + parch + fare + embarked,
data=titanic, method = "reverse")
library(rpart)
library(rpart.plot)
set.seed(100)
trainingRowIndex = sample(1:nrow(titanic), 0.8*nrow(titanic))
trainingData = titanic[trainingRowIndex,]
testData = titanic[-trainingRowIndex,]
dt1 = rpart(survived~pclass+sex+age+sibsp+parch+fare+embarked,
data=trainingData)
prp(dt1, type=0, extra=2, digits=4)
prediction = predict(dt1, testData, type="class")
table(ifelse(testData$survived == prediction, "yes", "no"))
titanic = read.csv("titanic_clean.csv", header=T, sep=",")
str(titanic)
titanic$pclass=as.factor(titanic$pclass)
titanic$name=as.character(titanic$name)
titanic$ticket=as.character(titanic$ticket)
titanic$cabin=as.character(titanic$cabin)
titanic$survived=factor(titanic$survived, levels=c(0,1))
ggplot(titanic, aes(x=factor(pclass), fill=factor(sex)))+
geom_bar(position = "dodge")
library(rpart)
library(rpart.plot)
library(ggplot2)
titanic = read.csv("titanic_clean.csv", header=T, sep=",")
str(titanic)
titanic$pclass=as.factor(titanic$pclass)
titanic$name=as.character(titanic$name)
titanic$ticket=as.character(titanic$ticket)
titanic$cabin=as.character(titanic$cabin)
titanic$survived=factor(titanic$survived, levels=c(0,1))
ggplot(titanic, aes(x=factor(pclass), fill=factor(sex)))+
geom_bar(position = "dodge")
ggplot(titanic, aes(x=factor(pclass), fill=factor(sex)))+
geom_bar(position = "dodge") +
facet_grid(".~survived")
posn.j=position_jitter(0.3,0)
ggplot(titanic, aes(x=factor(pclass), y=age, col=factor(sex)))+
geom_jitter(size=3, alpha=0.5, position=posn.j)+
facet_grid(".~survived")
mosaicplot(survived~pclass+sex, main="pclass and sex", data=titanic,
color = T)
library(Hmisc)
summary(survived~pclass + sex + age + sibsp + parch + fare + embarked,
data=titanic, method = "reverse")
library(rpart)
library(rpart.plot)
set.seed(100)
trainingRowIndex = sample(1:nrow(titanic), 0.8*nrow(titanic))
trainingData = titanic[trainingRowIndex,]
testData = titanic[-trainingRowIndex,]
dt1 = rpart(survived~pclass+sex+age+sibsp+parch+fare+embarked,
data=trainingData)
prp(dt1, type=0, extra=2, digits=4)
prediction = predict(dt1, testData, type="class")
table(ifelse(testData$survived == prediction, "yes", "no"))
